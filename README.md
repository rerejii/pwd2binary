# pwd2binary
研究で使用しているTensorflowによる深層学習のフレームワーク

## 研究テーマ
深層学習による傷が付いているプリント配線板画像の２値化に関する研究

## 研究概要
深層学習(AI)を用いてスマートフォンやPCの基板を対象に、傷汚れがついた撮影画像から、導電体・絶縁体の位置を推測させた画像を自動生成することが目的です。この研究の第1段階は基板解析業務の効率化に貢献しました。今後も同じテーマで研究を続ける予定です。
ライブラリ⇒TensorFlow、言語⇒Python

学部卒業研究梗概: https://www.kochi-tech.ac.jp/library/ron/pdf/2018/03/13/a1190361.pdf

学会発表歴
- 第36回センシングフォーラム
- 第23回パターン計測シンポジウム
- 平成30年度電気関係学会四国支部連合大会
- (第26回画像センシングシンポジウム 発表予定)

![lab2](https://user-images.githubusercontent.com/18644840/79046554-a07b1100-7c4c-11ea-93d5-b07fd6b27b9b.png)

## プログラム説明
#### main_template.py
実行用プログラムのテンプレートです。ここに実行条件や入出力パスを記載して実行させます。
#### func/DataManager.py
データセット管理用のクラスです。Tensorflow Dataset>画像パス>ミニバッチ>画像読み出し>画像正規化の処理を行う他、データの残量管理等を行います。
#### func/FitManager.py
学習時用のクラスです。学習中の評価やデータの書き出し処理を行います。
#### func/ImageGenerator.py
画像生成用のクラスです。学習後のモデルを使用して推測画像を生成させます。また生成速度を計測するのにも使用します。
#### func/PathManager.py
入出力パス管理用のクラスです。基本的にこのクラスを呼び出してパスを生成させることで、データ管理の煩雑性を軽減させることを目的としています。
#### func/PlotFunc.py
グラフ出力用クラスです。FitManager.pyにて生成されたcsvファイルにてグラフを生成させます。
#### func/ShareNetFunc.py
汎用的な関数をまとめたクラスです。
#### net_cls
ネットワークのモデルについて記載したクラスです。encode.pyは学部時に使用していたモデル、unet.pyはpix2pixのモデルを参考に構成させていただいたものです。

## 主な使用ライブラリ
- Tensorflow (keras)
- pandas
- numpy

## 研究memo

### 目指す方向(評価基準)
#### 2値分類の正解率向上(汎化性能の向上)
現在は対応できる画像特徴を増やすために、学習データ数を増やした際の正解率を高めることを行っています。
#### 短絡・断線数の減少
電気的な関係性を考慮するために、推論画像の短絡・断線数を減らすことを考慮しています。現在は白黒画像の境界からの距離をもとに重みをかけた学習させることで、線が密集しているポイントを効率的に学習させることを図っています。
#### 処理速度向上
最終的にはCPUで動作させるために、処理速度の向上を図っています。
現状はネットワークの出力を確認することで、反応する特徴について確認し、不必要なパラメータの削減を目指します。

### 考察点
- データ量が少ない時のデータ増強手法(回転による増加を180回転のみにして、傷の向きを統一)
- 大きなカーネルより小さなカーネルを重ねる
- lossに白黒の境界からの距離をもとに重みをかけた学習(細い線を重点的に学習)
- CNNの受容野を意識した学習(特徴マップ圧縮、深さ増大、Dilated Convolution)
- 画像の繋がりを意識した学習(not zero padding)
- Deep Otsuの手法をもとにした、ネットワークに画像生成ではなく、傷を除去することに特化させた手法
- ネットワークの出力を確認し、不必要なパラメータの削減して、処理速度の向上(これから)

### その他
学習データや学習後モデルについては公開できません。
